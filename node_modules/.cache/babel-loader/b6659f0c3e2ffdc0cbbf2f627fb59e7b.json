{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { onSnapshot, collection, query, where } from \"firebase/firestore\";\nimport { useEffect } from \"react\";\nimport create from \"zustand\";\nimport { firestore } from \"./firebase\";\nconst useStore = create(set => ({\n  profile: {},\n  setProfile: profile => set({\n    profile\n  })\n}));\nconst COLLLECTION_NAME = \"profiles\";\nexport const useProfile = ({\n  userId\n}) => {\n  _s();\n\n  const {\n    profile,\n    setProfile\n  } = useStore();\n  useEffect(() => {\n    const profilesRef = collection(firestore, COLLLECTION_NAME);\n    const profileQuery = query(profilesRef, where(\"userId\", \"==\", userId));\n    const unsubscribe = onSnapshot(profileQuery, snapshot => {\n      const profiles = snapshot.docs.map(doc => {\n        const data = doc.data();\n        return data;\n      });\n      setProfile(profiles[0]);\n    });\n    return () => {\n      unsubscribe();\n    };\n  }, [userId, setProfile]);\n  return {\n    profile\n  };\n};\n\n_s(useProfile, \"xyyd5sA9q1M6QRBFRGPpqQqIzYY=\", false, function () {\n  return [useStore];\n});","map":{"version":3,"sources":["/Users/christophervouga/Documents/projects/fake-id/src/data-access/profile.ts"],"names":["onSnapshot","collection","query","where","useEffect","create","firestore","useStore","set","profile","setProfile","COLLLECTION_NAME","useProfile","userId","profilesRef","profileQuery","unsubscribe","snapshot","profiles","docs","map","doc","data"],"mappings":";;AAAA,SAASA,UAAT,EAAqBC,UAArB,EAAiCC,KAAjC,EAAwCC,KAAxC,QAAqD,oBAArD;AACA,SAASC,SAAT,QAA0B,OAA1B;AACA,OAAOC,MAAP,MAAmB,SAAnB;AACA,SAASC,SAAT,QAA0B,YAA1B;AAaA,MAAMC,QAAQ,GAAGF,MAAM,CAAUG,GAAD,KAAU;AACxCC,EAAAA,OAAO,EAAE,EAD+B;AAExCC,EAAAA,UAAU,EAAGD,OAAD,IAAaD,GAAG,CAAC;AAAEC,IAAAA;AAAF,GAAD;AAFY,CAAV,CAAT,CAAvB;AAKA,MAAME,gBAAgB,GAAG,UAAzB;AAEA,OAAO,MAAMC,UAAU,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAoC;AAAA;;AAC5D,QAAM;AAAEJ,IAAAA,OAAF;AAAWC,IAAAA;AAAX,MAA0BH,QAAQ,EAAxC;AAEAH,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMU,WAAW,GAAGb,UAAU,CAACK,SAAD,EAAYK,gBAAZ,CAA9B;AAEA,UAAMI,YAAY,GAAGb,KAAK,CAACY,WAAD,EAAcX,KAAK,CAAC,QAAD,EAAW,IAAX,EAAiBU,MAAjB,CAAnB,CAA1B;AAEA,UAAMG,WAAW,GAAGhB,UAAU,CAACe,YAAD,EAAgBE,QAAD,IAAc;AACzD,YAAMC,QAAQ,GAAGD,QAAQ,CAACE,IAAT,CAAcC,GAAd,CAAmBC,GAAD,IAAS;AAC1C,cAAMC,IAAI,GAAGD,GAAG,CAACC,IAAJ,EAAb;AACA,eAAOA,IAAP;AACD,OAHgB,CAAjB;AAKAZ,MAAAA,UAAU,CAACQ,QAAQ,CAAC,CAAD,CAAT,CAAV;AACD,KAP6B,CAA9B;AASA,WAAO,MAAM;AACXF,MAAAA,WAAW;AACZ,KAFD;AAGD,GAjBQ,EAiBN,CAACH,MAAD,EAASH,UAAT,CAjBM,CAAT;AAmBA,SAAO;AACLD,IAAAA;AADK,GAAP;AAGD,CAzBM;;GAAMG,U;UACqBL,Q","sourcesContent":["import { onSnapshot, collection, query, where } from \"firebase/firestore\";\nimport { useEffect } from \"react\";\nimport create from \"zustand\";\nimport { firestore } from \"./firebase\";\n\ntype IProfile = {\n  userId: string;\n  displayName?: string;\n  profilePictureUrl?: string;\n};\n\ntype IStore = {\n  profile: Partial<IProfile>;\n  setProfile: (profile: IProfile) => void;\n};\n\nconst useStore = create<IStore>((set) => ({\n  profile: {},\n  setProfile: (profile) => set({ profile }),\n}));\n\nconst COLLLECTION_NAME = \"profiles\";\n\nexport const useProfile = ({ userId }: { userId: string }) => {\n  const { profile, setProfile } = useStore();\n\n  useEffect(() => {\n    const profilesRef = collection(firestore, COLLLECTION_NAME);\n\n    const profileQuery = query(profilesRef, where(\"userId\", \"==\", userId));\n\n    const unsubscribe = onSnapshot(profileQuery, (snapshot) => {\n      const profiles = snapshot.docs.map((doc) => {\n        const data = doc.data();\n        return data as IProfile;\n      });\n\n      setProfile(profiles[0]);\n    });\n\n    return () => {\n      unsubscribe();\n    };\n  }, [userId, setProfile]);\n\n  return {\n    profile,\n  };\n};\n"]},"metadata":{},"sourceType":"module"}