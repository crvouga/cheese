{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { addDoc, onSnapshot, collection, query, where } from \"firebase/firestore\";\nimport { useEffect } from \"react\";\nimport create from \"zustand\";\nimport { firestore } from \"./firebase\";\nconst useStore = create(set => ({\n  setProfile: profile => set({\n    profile\n  })\n}));\nconst COLLLECTION_NAME = \"profiles\";\nconst profilesRef = collection(firestore, COLLLECTION_NAME);\nexport const useProfile = ({\n  userId\n}) => {\n  _s();\n\n  const {\n    profile,\n    setProfile\n  } = useStore();\n  useEffect(() => {\n    const profileQuery = query(profilesRef, where(\"userId\", \"==\", userId));\n    const unsubscribe = onSnapshot(profileQuery, snapshot => {\n      const profiles = snapshot.docs.map(doc => {\n        const data = doc.data();\n        return data;\n      });\n      setProfile(profiles[0]);\n    });\n    return () => {\n      unsubscribe();\n    };\n  }, [userId, setProfile]);\n\n  const addProfile = async profile => {\n    await addDoc(profilesRef, {\n      displayName,\n      userId,\n      profilePictureUrl\n    });\n  };\n\n  return {\n    profile,\n    addProfile\n  };\n};\n\n_s(useProfile, \"xyyd5sA9q1M6QRBFRGPpqQqIzYY=\", false, function () {\n  return [useStore];\n});","map":{"version":3,"sources":["/Users/christophervouga/Documents/projects/fake-id/src/data-access/profile.ts"],"names":["addDoc","onSnapshot","collection","query","where","useEffect","create","firestore","useStore","set","setProfile","profile","COLLLECTION_NAME","profilesRef","useProfile","userId","profileQuery","unsubscribe","snapshot","profiles","docs","map","doc","data","addProfile","displayName","profilePictureUrl"],"mappings":";;AAAA,SACEA,MADF,EAEEC,UAFF,EAGEC,UAHF,EAIEC,KAJF,EAKEC,KALF,QAMO,oBANP;AAOA,SAASC,SAAT,QAA0B,OAA1B;AACA,OAAOC,MAAP,MAAmB,SAAnB;AACA,SAASC,SAAT,QAA0B,YAA1B;AAaA,MAAMC,QAAQ,GAAGF,MAAM,CAAUG,GAAD,KAAU;AACxCC,EAAAA,UAAU,EAAGC,OAAD,IAAaF,GAAG,CAAC;AAAEE,IAAAA;AAAF,GAAD;AADY,CAAV,CAAT,CAAvB;AAIA,MAAMC,gBAAgB,GAAG,UAAzB;AACA,MAAMC,WAAW,GAAGX,UAAU,CAACK,SAAD,EAAYK,gBAAZ,CAA9B;AAEA,OAAO,MAAME,UAAU,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAoC;AAAA;;AAC5D,QAAM;AAAEJ,IAAAA,OAAF;AAAWD,IAAAA;AAAX,MAA0BF,QAAQ,EAAxC;AAEAH,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMW,YAAY,GAAGb,KAAK,CAACU,WAAD,EAAcT,KAAK,CAAC,QAAD,EAAW,IAAX,EAAiBW,MAAjB,CAAnB,CAA1B;AAEA,UAAME,WAAW,GAAGhB,UAAU,CAACe,YAAD,EAAgBE,QAAD,IAAc;AACzD,YAAMC,QAAQ,GAAGD,QAAQ,CAACE,IAAT,CAAcC,GAAd,CAAmBC,GAAD,IAAS;AAC1C,cAAMC,IAAI,GAAGD,GAAG,CAACC,IAAJ,EAAb;AACA,eAAOA,IAAP;AACD,OAHgB,CAAjB;AAKAb,MAAAA,UAAU,CAACS,QAAQ,CAAC,CAAD,CAAT,CAAV;AACD,KAP6B,CAA9B;AASA,WAAO,MAAM;AACXF,MAAAA,WAAW;AACZ,KAFD;AAGD,GAfQ,EAeN,CAACF,MAAD,EAASL,UAAT,CAfM,CAAT;;AAiBA,QAAMc,UAAU,GAAG,MAAOb,OAAP,IAIb;AACJ,UAAMX,MAAM,CAACa,WAAD,EAAc;AACxBY,MAAAA,WADwB;AAExBV,MAAAA,MAFwB;AAGxBW,MAAAA;AAHwB,KAAd,CAAZ;AAKD,GAVD;;AAYA,SAAO;AACLf,IAAAA,OADK;AAELa,IAAAA;AAFK,GAAP;AAID,CApCM;;GAAMV,U;UACqBN,Q","sourcesContent":["import {\n  addDoc,\n  onSnapshot,\n  collection,\n  query,\n  where,\n} from \"firebase/firestore\";\nimport { useEffect } from \"react\";\nimport create from \"zustand\";\nimport { firestore } from \"./firebase\";\n\ntype IProfile = {\n  userId: string;\n  displayName?: string;\n  profilePictureUrl?: string;\n};\n\ntype IStore = {\n  profile?: Partial<IProfile>;\n  setProfile: (profile: IProfile) => void;\n};\n\nconst useStore = create<IStore>((set) => ({\n  setProfile: (profile) => set({ profile }),\n}));\n\nconst COLLLECTION_NAME = \"profiles\";\nconst profilesRef = collection(firestore, COLLLECTION_NAME);\n\nexport const useProfile = ({ userId }: { userId: string }) => {\n  const { profile, setProfile } = useStore();\n\n  useEffect(() => {\n    const profileQuery = query(profilesRef, where(\"userId\", \"==\", userId));\n\n    const unsubscribe = onSnapshot(profileQuery, (snapshot) => {\n      const profiles = snapshot.docs.map((doc) => {\n        const data = doc.data();\n        return data as IProfile;\n      });\n\n      setProfile(profiles[0]);\n    });\n\n    return () => {\n      unsubscribe();\n    };\n  }, [userId, setProfile]);\n\n  const addProfile = async (profile: {\n    displayName: string;\n    userId: string;\n    profilePictureUrl: string;\n  }) => {\n    await addDoc(profilesRef, {\n      displayName,\n      userId,\n      profilePictureUrl,\n    });\n  };\n\n  return {\n    profile,\n    addProfile,\n  };\n};\n"]},"metadata":{},"sourceType":"module"}