{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport create from \"zustand\";\nimport { initializeApp } from \"firebase/app\";\nimport { onAuthStateChanged as onFirebaseAuthStateChanged, GoogleAuthProvider, signInWithRedirect, getAuth } from \"firebase/auth\";\nimport { useEffect } from \"react\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyBG4p0DbPxzwlZ2N6iDnIc8rluD6maVO0g\",\n  authDomain: \"fake-id-4ffcb.firebaseapp.com\",\n  projectId: \"fake-id-4ffcb\",\n  storageBucket: \"fake-id-4ffcb.appspot.com\",\n  messagingSenderId: \"932010719951\",\n  appId: \"1:932010719951:web:40472818ed8495992cd5ba\",\n  measurementId: \"G-1CJF5B61SR\"\n};\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nexport const signIn = async ({\n  authMethod\n}) => {\n  if (authMethod === \"google\") {\n    const googleAuthProvider = new GoogleAuthProvider();\n    await signInWithRedirect(auth, googleAuthProvider);\n    return [];\n  }\n\n  return [new Error(\"unsupported auth method\")];\n};\nexport const onAuthStateChanged = set => {\n  set({\n    status: \"loading\"\n  });\n  return onFirebaseAuthStateChanged(auth, firebaseUser => {\n    if (firebaseUser) {\n      set({\n        status: \"auth\",\n        authUser: {\n          userId: firebaseUser.uid\n        }\n      });\n      return;\n    }\n\n    set({\n      status: \"unauth\"\n    });\n  });\n};\nconst useStore = create(set => ({\n  authState: {\n    status: \"loading\"\n  },\n  setAuthState: authState => set({\n    authState\n  })\n}));\nexport const useAuthState = () => {\n  _s();\n\n  const {\n    authState,\n    setAuthState\n  } = useStore();\n  useEffect(() => {\n    return onAuthStateChanged(setAuthState);\n  }, []);\n  return authState;\n};\n\n_s(useAuthState, \"5s2/oJT6vtICe7n1V97DDJczBJ4=\", false, function () {\n  return [useStore];\n});","map":{"version":3,"sources":["/Users/christophervouga/Documents/projects/fake-id/src/data-access/index.ts"],"names":["create","initializeApp","onAuthStateChanged","onFirebaseAuthStateChanged","GoogleAuthProvider","signInWithRedirect","getAuth","useEffect","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","app","auth","signIn","authMethod","googleAuthProvider","Error","set","status","firebaseUser","authUser","userId","uid","useStore","authState","setAuthState","useAuthState"],"mappings":";;AAAA,OAAOA,MAAP,MAAmB,SAAnB;AACA,SAASC,aAAT,QAA8B,cAA9B;AACA,SACEC,kBAAkB,IAAIC,0BADxB,EAEEC,kBAFF,EAGEC,kBAHF,EAIEC,OAJF,QAKO,eALP;AAMA,SAASC,SAAT,QAA0B,OAA1B;AAEA,MAAMC,cAAc,GAAG;AACrBC,EAAAA,MAAM,EAAE,yCADa;AAErBC,EAAAA,UAAU,EAAE,+BAFS;AAGrBC,EAAAA,SAAS,EAAE,eAHU;AAIrBC,EAAAA,aAAa,EAAE,2BAJM;AAKrBC,EAAAA,iBAAiB,EAAE,cALE;AAMrBC,EAAAA,KAAK,EAAE,2CANc;AAOrBC,EAAAA,aAAa,EAAE;AAPM,CAAvB;AAUA,MAAMC,GAAG,GAAGf,aAAa,CAACO,cAAD,CAAzB;AACA,MAAMS,IAAI,GAAGX,OAAO,CAACU,GAAD,CAApB;AAIA,OAAO,MAAME,MAAM,GAAG,OAAO;AAAEC,EAAAA;AAAF,CAAP,KAAuD;AAC3E,MAAIA,UAAU,KAAK,QAAnB,EAA6B;AAC3B,UAAMC,kBAAkB,GAAG,IAAIhB,kBAAJ,EAA3B;AAEA,UAAMC,kBAAkB,CAACY,IAAD,EAAOG,kBAAP,CAAxB;AAEA,WAAO,EAAP;AACD;;AAED,SAAO,CAAC,IAAIC,KAAJ,CAAU,yBAAV,CAAD,CAAP;AACD,CAVM;AA0BP,OAAO,MAAMnB,kBAAkB,GAC7BoB,GADgC,IAEf;AACjBA,EAAAA,GAAG,CAAC;AAAEC,IAAAA,MAAM,EAAE;AAAV,GAAD,CAAH;AACA,SAAOpB,0BAA0B,CAACc,IAAD,EAAQO,YAAD,IAAkB;AACxD,QAAIA,YAAJ,EAAkB;AAChBF,MAAAA,GAAG,CAAC;AACFC,QAAAA,MAAM,EAAE,MADN;AAEFE,QAAAA,QAAQ,EAAE;AACRC,UAAAA,MAAM,EAAEF,YAAY,CAACG;AADb;AAFR,OAAD,CAAH;AAMA;AACD;;AAEDL,IAAAA,GAAG,CAAC;AACFC,MAAAA,MAAM,EAAE;AADN,KAAD,CAAH;AAGD,GAdgC,CAAjC;AAeD,CAnBM;AA0BP,MAAMK,QAAQ,GAAG5B,MAAM,CAAUsB,GAAD,KAAU;AACxCO,EAAAA,SAAS,EAAE;AACTN,IAAAA,MAAM,EAAE;AADC,GAD6B;AAKxCO,EAAAA,YAAY,EAAGD,SAAD,IAAeP,GAAG,CAAC;AAAEO,IAAAA;AAAF,GAAD;AALQ,CAAV,CAAT,CAAvB;AAQA,OAAO,MAAME,YAAY,GAAG,MAAM;AAAA;;AAChC,QAAM;AAAEF,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAA8BF,QAAQ,EAA5C;AAEArB,EAAAA,SAAS,CAAC,MAAM;AACd,WAAOL,kBAAkB,CAAC4B,YAAD,CAAzB;AACD,GAFQ,EAEN,EAFM,CAAT;AAIA,SAAOD,SAAP;AACD,CARM;;GAAME,Y;UACyBH,Q","sourcesContent":["import create from \"zustand\";\nimport { initializeApp } from \"firebase/app\";\nimport {\n  onAuthStateChanged as onFirebaseAuthStateChanged,\n  GoogleAuthProvider,\n  signInWithRedirect,\n  getAuth,\n} from \"firebase/auth\";\nimport { useEffect } from \"react\";\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyBG4p0DbPxzwlZ2N6iDnIc8rluD6maVO0g\",\n  authDomain: \"fake-id-4ffcb.firebaseapp.com\",\n  projectId: \"fake-id-4ffcb\",\n  storageBucket: \"fake-id-4ffcb.appspot.com\",\n  messagingSenderId: \"932010719951\",\n  appId: \"1:932010719951:web:40472818ed8495992cd5ba\",\n  measurementId: \"G-1CJF5B61SR\",\n};\n\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\n\ntype IAuthMethod = \"google\";\n\nexport const signIn = async ({ authMethod }: { authMethod: IAuthMethod }) => {\n  if (authMethod === \"google\") {\n    const googleAuthProvider = new GoogleAuthProvider();\n\n    await signInWithRedirect(auth, googleAuthProvider);\n\n    return [];\n  }\n\n  return [new Error(\"unsupported auth method\")];\n};\n\ntype IAuthState =\n  | {\n      status: \"loading\";\n    }\n  | {\n      status: \"auth\";\n      authUser: {\n        userId: string;\n      };\n    }\n  | {\n      status: \"unauth\";\n    };\n\nexport const onAuthStateChanged = (\n  set: (authState: IAuthState) => void\n): (() => void) => {\n  set({ status: \"loading\" });\n  return onFirebaseAuthStateChanged(auth, (firebaseUser) => {\n    if (firebaseUser) {\n      set({\n        status: \"auth\",\n        authUser: {\n          userId: firebaseUser.uid,\n        },\n      });\n      return;\n    }\n\n    set({\n      status: \"unauth\",\n    });\n  });\n};\n\ntype IStore = {\n  authState: IAuthState;\n  setAuthState: (authState: IAuthState) => void;\n};\n\nconst useStore = create<IStore>((set) => ({\n  authState: {\n    status: \"loading\",\n  },\n\n  setAuthState: (authState) => set({ authState }),\n}));\n\nexport const useAuthState = () => {\n  const { authState, setAuthState } = useStore();\n\n  useEffect(() => {\n    return onAuthStateChanged(setAuthState);\n  }, []);\n\n  return authState;\n};\n"]},"metadata":{},"sourceType":"module"}